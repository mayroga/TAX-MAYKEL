<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AL CIELO - Senior Tax Intelligence Portal</title>
    <style>
        :root { --drake-blue: #002D54; --gold: #C5A059; --irs-green: #27AE60; --danger: #C0392B; }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #1A1A1A; color: #333; height: 100vh; display: flex; flex-direction: column; }
        
        /* Barra de Transmisi√≥n (Estilo Drake) */
        .status-bar { background: #000; color: #00FF00; padding: 10px 25px; display: flex; justify-content: space-between; font-family: 'Courier New', monospace; font-size: 1.1rem; border-bottom: 2px solid var(--gold); }
        
        .main-layout { display: grid; grid-template-columns: 240px 1fr 400px; flex-grow: 1; overflow: hidden; }
        
        /* Navegaci√≥n por Formularios */
        .sidebar { background: #2C3E50; color: white; padding: 15px; }
        .nav-grp { font-size: 0.75rem; color: #BDC3C7; text-transform: uppercase; margin: 15px 0 5px 5px; border-bottom: 1px solid #465669; }
        .nav-item { padding: 12px; cursor: pointer; border-bottom: 1px solid #34495E; font-size: 0.85rem; transition: 0.2s; }
        .nav-item:hover, .active { background: var(--gold); color: black; font-weight: bold; }

        /* Espacio de Trabajo (C√°lculos en Tiempo Real) */
        .workspace { background: white; padding: 25px; overflow-y: auto; border-right: 2px solid #CCC; }
        .form-header { background: #ECF0F1; padding: 10px; border: 1px solid #BDC3C7; font-weight: bold; color: var(--drake-blue); margin-bottom: 15px; }
        .tax-row { display: grid; grid-template-columns: 60px 1fr 180px; border-bottom: 1px solid #EEE; align-items: center; }
        .ln { background: #F4F4F4; padding: 10px; text-align: center; font-weight: bold; border-right: 1px solid #DDD; font-size: 0.8rem; }
        input, select { width: 100%; border: none; padding: 10px; text-align: right; font-size: 1.1rem; background: #FFFDE7; outline: none; }
        input:focus { background: white; border-bottom: 2px solid var(--drake-blue); }
        .highlight { background: #E8F8F5 !important; font-weight: bold; }

        /* Cerebro de AURA (Contador Senior Obligado) */
        .aura-panel { background: #FDFEFE; display: flex; flex-direction: column; border-left: 2px solid var(--gold); }
        .aura-header { background: var(--drake-blue); color: white; padding: 15px; text-align: center; font-weight: bold; }
        .aura-chat { flex-grow: 1; padding: 15px; overflow-y: auto; background: #F4F7F6; font-size: 0.9rem; }
        .aura-input { padding: 15px; border-top: 1px solid #CCC; }
        #query { width: 100%; padding: 12px; border: 2px solid var(--drake-blue); border-radius: 4px; }
        .msg-bot { background: white; padding: 12px; border-left: 4px solid var(--irs-green); margin-bottom: 10px; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .msg-alert { background: #FDEDEC; padding: 12px; border-left: 4px solid var(--danger); margin-bottom: 10px; font-weight: bold; color: var(--danger); }

        .btn-footer { padding: 15px; background: #BDC3C7; display: flex; gap: 15px; justify-content: flex-end; }
        button { padding: 10px 25px; cursor: pointer; font-weight: bold; border: none; border-radius: 3px; text-transform: uppercase; }
        .btn-p { background: var(--drake-blue); color: white; }
        .btn-d { background: var(--danger); color: white; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="status-bar">
    <span>[REFUND/OWE]: <span id="st-tax">$0.00</span></span>
    <span>[AGI]: <span id="st-agi">$0.00</span></span>
    <span>[TAXPAYER]: <span id="st-name">---</span></span>
</div>

<div class="main-layout">
    <nav class="sidebar">
        <div class="nav-grp">Income Forms</div>
        <div class="nav-item active" onclick="show('1040')">Form 1040 (Main)</div>
        <div class="nav-item" onclick="show('schc')">Schedule C (Business)</div>
        <div class="nav-grp">Adjustments</div>
        <div class="nav-item" onclick="show('4562')">Form 4562 (Depreciation)</div>
        <div class="nav-item" onclick="show('8829')">Form 8829 (Home Office)</div>
    </nav>

    <main class="workspace">
        <div id="f-1040">
            <div class="form-header">Form 1040 - U.S. Individual Income Tax 2026</div>
            <div class="tax-row"><div class="ln">NAME</div><div class="desc">Taxpayer Name</div><input type="text" id="name" placeholder="Legal Name" oninput="calc()"></div>
            <div class="tax-row"><div class="ln">STAT</div><div class="desc">Filing Status</div>
                <select id="status" onchange="calc()">
                    <option value="single">Single</option>
                    <option value="mfj">Married Filing Jointly</option>
                    <option value="hoh">Head of Household</option>
                </select>
            </div>
            <div class="tax-row"><div class="ln">1z</div><div class="desc">Wages (W-2)</div><input type="number" id="w2" value="0" oninput="calc()"></div>
            <div class="tax-row"><div class="ln">8</div><div class="desc">Schedule C Business Income</div><input type="number" id="link_schc" readonly></div>
            <div class="tax-row highlight"><div class="ln">11</div><div class="desc">ADJUSTED GROSS INCOME (AGI)</div><input type="number" id="agi" readonly></div>
        </div>

        <div id="f-schc" class="hidden">
            <div class="form-header">Schedule C - Profit or Loss From Business</div>
            <div class="tax-row"><div class="ln">1</div><div class="desc">Gross Receipts or Sales</div><input type="number" id="gross" value="0" oninput="calc()"></div>
            <div class="tax-row"><div class="ln">13</div><div class="desc">Depreciation (From 4562)</div><input type="number" id="link_dep" readonly></div>
            <div class="tax-row"><div class="ln">28</div><div class="desc">Other Business Expenses</div><input type="number" id="expenses" value="0" oninput="calc()"></div>
            <div class="tax-row highlight"><div class="ln">31</div><div class="desc">NET PROFIT</div><input type="number" id="net" readonly></div>
        </div>

        <div id="f-4562" class="hidden">
            <div class="form-header">Form 4562 - Depreciation (Sec. 179)</div>
            <div class="tax-row"><div class="ln">1</div><div class="desc">Section 179 Deduction</div><input type="number" id="s179" value="0" oninput="calc()"></div>
            <div class="tax-row"><div class="ln">19</div><div class="desc">MACRS Depreciation</div><input type="number" id="macrs" value="0" oninput="calc()"></div>
            <div class="tax-row highlight"><div class="ln">22</div><div class="desc">TOTAL DEPRECIATION</div><input type="number" id="tdep" readonly></div>
        </div>
    </main>

    <aside class="aura-panel">
        <div class="aura-header">üß† AURA SENIOR TAX SPECIALIST</div>
        <div class="aura-chat" id="chat">
            <div class="msg-bot">AURA: Sistema Senior listo. He analizado el IRC 2026. Estoy monitoreando errores de c√°lculo y oportunidades de deducci√≥n en tiempo real.</div>
        </div>
        <div class="aura-input">
            <input type="text" id="query" placeholder="Consulte sobre leyes del IRS..." onkeypress="ask(event)">
        </div>
    </aside>
</div>

<div class="btn-footer">
    <button class="btn-d" onclick="location.reload()">Borrar Todo</button>
    <button class="btn-p" onclick="window.print()">Imprimir PDF Transcription</button>
</div>

<script>
    function calc() {
        const name = document.getElementById('name').value.toUpperCase();
        const w2 = parseFloat(document.getElementById('w2').value) || 0;
        const gross = parseFloat(document.getElementById('gross').value) || 0;
        const exp = parseFloat(document.getElementById('expenses').value) || 0;
        const s179 = parseFloat(document.getElementById('s179').value) || 0;
        const macrs = parseFloat(document.getElementById('macrs').value) || 0;
        const status = document.getElementById('status').value;

        // 1. Triangulaci√≥n de Datos (Flujo Drake)
        const tDep = s179 + macrs;
        document.getElementById('tdep').value = tDep.toFixed(2);
        document.getElementById('link_dep').value = tDep.toFixed(2);

        const netProfit = Math.max(0, gross - exp - tDep);
        document.getElementById('net').value = netProfit.toFixed(2);
        document.getElementById('link_schc').value = netProfit.toFixed(2);

        // 2. Impuesto de Auto-empleo (SE Tax 15.3%)
        const seTax = netProfit * 0.9235 * 0.153;

        // 3. C√°lculo de AGI
        const agi = (w2 + netProfit) - (seTax / 2);
        document.getElementById('agi').value = agi.toFixed(2);

        // 4. Impuesto Federal 2026
        const standardDed = { single: 15700, mfj: 31400, hoh: 23550 }[status];
        const taxable = Math.max(0, agi - standardDed);
        let incomeTax = taxable * (taxable > 50000 ? 0.22 : 0.12); // C√°lculo progresivo simplificado

        const totalTax = incomeTax + seTax;

        // 5. Actualizaci√≥n de Interfaz
        document.getElementById('st-name').innerText = name || "---";
        document.getElementById('st-agi').innerText = `$${agi.toLocaleString()}`;
        document.getElementById('st-tax').innerText = `$${totalTax.toLocaleString()}`;

        // IA Auditor√≠a Preventiva
        audit(gross, exp, netProfit, s179);
    }

    function audit(g, e, n, s) {
        if(e > (g * 0.6) && g > 0) pushAura("‚ö†Ô∏è ALERTA DE AUDITOR√çA: Sus gastos superan el 60% del ingreso bruto. Esto dispara alertas de 'Hobby Loss' en el IRS.", "msg-alert");
        if(n > 65000) pushAura("üí° ESTRATEGIA: Su utilidad neta justifica una S-Corp. Ahorrar√≠a aprox. $8,000 en SE Taxes.", "msg-bot");
        if(s > n && s > 0) pushAura("‚ùå ERROR T√âCNICO: La Secci√≥n 179 no puede crear p√©rdida neta seg√∫n el IRC Sec. 179(b)(3).", "msg-alert");
    }

    function ask(e) {
        if(e.key === 'Enter') {
            const q = e.target.value.toLowerCase();
            let r = "Como Contador Senior, le informo que esa consulta requiere revisar la Publicaci√≥n 17 y 535 del IRS.";

            if(q.includes("179")) r = "La Secci√≥n 179 permite deducir el 100% de activos comerciales (ej. camiones pesados >6000 lbs) en el a√±o 1, acelerando el flujo de caja.";
            if(q.includes("home office")) r = "Form 8829: El espacio debe ser oficina EXCLUSIVA. M√©todo simplificado: $5/sqft hasta 300 pies. M√©todo real: Prorrateo de gastos de casa.";
            if(q.includes("s-corp")) r = "La S-Corp es el blindaje fiscal definitivo. Separa su ingreso en salario y distribuciones, eliminando el 15.3% de impuestos en estas √∫ltimas.";
            if(q.includes("irs")) r = "El IRS est√° auditando agresivamente las deducciones de veh√≠culos en 2026. Aseg√∫rese de tener el Millaje Logbook al d√≠a.";

            pushAura(`<strong>Usted:</strong> ${e.target.value}`, "msg-bot");
            pushAura(`<strong>AURA:</strong> ${r}`, "msg-bot");
            e.target.value = "";
        }
    }

    function pushAura(m, cls) {
        const chat = document.getElementById('chat');
        if(chat.innerHTML.includes(m)) return;
        const div = document.createElement('div');
        div.className = cls;
        div.innerHTML = m;
        chat.appendChild(div);
        chat.scrollTop = chat.scrollHeight;
    }

    function show(id) {
        document.querySelectorAll('.workspace > div').forEach(d => d.classList.add('hidden'));
        document.getElementById('f-' + id).classList.remove('hidden');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        event.target.classList.add('active');
    }

    calc();
</script>
</body>
</html>
